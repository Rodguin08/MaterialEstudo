{"ast":null,"code":"'use strict';\n/**\n * `confirm` type prompt\n */\n\nconst chalk = require('chalk');\n\nconst {\n  take,\n  takeUntil\n} = require('rxjs/operators');\n\nconst Base = require('./base');\n\nconst observe = require('../utils/events');\n\nclass ConfirmPrompt extends Base {\n  constructor(questions, rl, answers) {\n    super(questions, rl, answers);\n    let rawDefault = true;\n    Object.assign(this.opt, {\n      filter(input) {\n        let value = rawDefault;\n\n        if (input != null && input !== '') {\n          value = /^y(es)?/i.test(input);\n        }\n\n        return value;\n      }\n\n    });\n\n    if (this.opt.default != null) {\n      rawDefault = Boolean(this.opt.default);\n    }\n\n    this.opt.default = rawDefault ? 'Y/n' : 'y/N';\n  }\n  /**\n   * Start the Inquiry session\n   * @param  {Function} cb   Callback when prompt is done\n   * @return {this}\n   */\n\n\n  _run(cb) {\n    this.done = cb; // Once user confirm (enter key)\n\n    const events = observe(this.rl);\n    events.keypress.pipe(takeUntil(events.line)).forEach(this.onKeypress.bind(this));\n    events.line.pipe(take(1)).forEach(this.onEnd.bind(this)); // Init\n\n    this.render();\n    return this;\n  }\n  /**\n   * Render the prompt to screen\n   * @return {ConfirmPrompt} self\n   */\n\n\n  render(answer) {\n    let message = this.getQuestion();\n\n    if (typeof answer === 'boolean') {\n      message += chalk.cyan(answer ? 'Yes' : 'No');\n    } else {\n      message += this.rl.line;\n    }\n\n    this.screen.render(message);\n    return this;\n  }\n  /**\n   * When user press `enter` key\n   */\n\n\n  onEnd(input) {\n    this.status = 'answered';\n    const output = this.opt.filter(input);\n    this.render(output);\n    this.screen.done();\n    this.done(output);\n  }\n  /**\n   * When user press a key\n   */\n\n\n  onKeypress() {\n    this.render();\n  }\n\n}\n\nmodule.exports = ConfirmPrompt;","map":null,"metadata":{},"sourceType":"script"}