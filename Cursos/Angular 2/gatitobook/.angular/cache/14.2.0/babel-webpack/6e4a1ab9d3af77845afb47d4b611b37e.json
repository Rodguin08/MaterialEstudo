{"ast":null,"code":"// Get the appropriate flag to use for creating files\n// We use fmap on Windows platforms for files less than\n// 512kb.  This is a fairly low limit, but avoids making\n// things slower in some cases.  Since most of what this\n// library is used for is extracting tarballs of many\n// relatively small files in npm packages and the like,\n// it can be a big boost on Windows platforms.\n// Only supported in Node v12.9.0 and above.\nconst platform = process.env.__FAKE_PLATFORM__ || process.platform;\nconst isWindows = platform === 'win32';\n\nconst fs = global.__FAKE_TESTING_FS__ || require('fs');\n/* istanbul ignore next */\n\n\nconst {\n  O_CREAT,\n  O_TRUNC,\n  O_WRONLY,\n  UV_FS_O_FILEMAP = 0\n} = fs.constants;\nconst fMapEnabled = isWindows && !!UV_FS_O_FILEMAP;\nconst fMapLimit = 512 * 1024;\nconst fMapFlag = UV_FS_O_FILEMAP | O_TRUNC | O_CREAT | O_WRONLY;\nmodule.exports = !fMapEnabled ? () => 'w' : size => size < fMapLimit ? fMapFlag : 'w';","map":null,"metadata":{},"sourceType":"script"}