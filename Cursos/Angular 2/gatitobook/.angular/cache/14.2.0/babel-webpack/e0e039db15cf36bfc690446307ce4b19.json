{"ast":null,"code":"'use strict';\n\nconst mimicFn = require('mimic-fn');\n\nconst calledFunctions = new WeakMap();\n\nconst onetime = (function_, options = {}) => {\n  if (typeof function_ !== 'function') {\n    throw new TypeError('Expected a function');\n  }\n\n  let returnValue;\n  let callCount = 0;\n  const functionName = function_.displayName || function_.name || '<anonymous>';\n\n  const onetime = function (...arguments_) {\n    calledFunctions.set(onetime, ++callCount);\n\n    if (callCount === 1) {\n      returnValue = function_.apply(this, arguments_);\n      function_ = null;\n    } else if (options.throw === true) {\n      throw new Error(`Function \\`${functionName}\\` can only be called once`);\n    }\n\n    return returnValue;\n  };\n\n  mimicFn(onetime, function_);\n  calledFunctions.set(onetime, callCount);\n  return onetime;\n};\n\nmodule.exports = onetime; // TODO: Remove this for the next major release\n\nmodule.exports.default = onetime;\n\nmodule.exports.callCount = function_ => {\n  if (!calledFunctions.has(function_)) {\n    throw new Error(`The given function \\`${function_.name}\\` is not wrapped by the \\`onetime\\` package`);\n  }\n\n  return calledFunctions.get(function_);\n};","map":null,"metadata":{},"sourceType":"script"}